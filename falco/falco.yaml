# Falco 런타임 위협 탐지 설정
# ⚠️ Linux 서버에서만 사용 가능 (커널 모듈 필요)

# JSON 출력 활성화 (Loki 연동용)
json_output: true
json_include_output_property: true
json_include_tags_property: true

# 로그 설정
log_stderr: true
log_syslog: false
log_level: info

# 출력 설정
stdout_output:
  enabled: true

file_output:
  enabled: false
  keep_alive: false
  filename: /var/log/falco/events.log

# HTTP 출력 (Falco Sidekick으로 전송)
http_output:
  enabled: true
  url: http://falco-sidekick:2801/
  user_agent: "falco/runtime-security"

# 기본 규칙
rules_file:
  - /etc/falco/falco_rules.yaml
  - /etc/falco/falco_rules.local.yaml
  - /etc/falco/k8s_audit_rules.yaml
  - /etc/falco/rules.d

# 프로그램 출력
program_output:
  enabled: false

# gRPC 출력
grpc_output:
  enabled: false

# 버퍼 설정
buffered_outputs: false

# 시스템콜 이벤트 드롭 알림
syscall_event_drops:
  threshold: .1
  actions:
    - log
    - alert
  rate: .03333
  max_burst: 1

# 컨테이너 메타데이터 수집
metadata_download:
  max_mb: 100
  chunk_wait_us: 1000
  watch_freq_sec: 1

# 우선순위 필터 (WARNING 이상만)
priority: WARNING

# 태그 설정 (Loki 레이블로 사용)
tags:
  - security
  - runtime
  - container

