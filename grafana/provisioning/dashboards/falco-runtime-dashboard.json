{
  "annotations": { "list": [] },
  "editable": true,
  "fiscalYearStartMonth": 0,
  "graphTooltip": 0,
  "id": null,
  "links": [
    {
      "asDropdown": false,
      "icon": "dashboard",
      "title": "ğŸš¨ ë³´ì•ˆ ë¡œê·¸",
      "type": "link",
      "url": "/d/security-logs/"
    }
  ],
  "liveNow": true,
  "refresh": "5s",
  "schemaVersion": 38,
  "tags": ["falco", "runtime", "security", "threats"],
  "templating": {
    "list": [
      {
        "current": { "selected": true, "text": "All", "value": "$__all" },
        "datasource": { "type": "loki", "uid": "loki" },
        "definition": "label_values({job=\"falco\"}, priority)",
        "hide": 0,
        "includeAll": true,
        "label": "Priority",
        "multi": true,
        "name": "priority",
        "options": [],
        "query": "label_values({job=\"falco\"}, priority)",
        "refresh": 2,
        "sort": 1,
        "type": "query"
      }
    ]
  },
  "time": { "from": "now-1h", "to": "now" },
  "title": "ğŸ¦… Falco Runtime Security",
  "uid": "falco-runtime",
  "version": 1,
  "panels": [
    {
      "id": 1,
      "title": "âš ï¸ Falco ë¯¸ì„¤ì¹˜ ì•ˆë‚´",
      "type": "text",
      "gridPos": { "h": 4, "w": 24, "x": 0, "y": 0 },
      "options": {
        "mode": "markdown",
        "content": "## ğŸ¦… Falco ëŸ°íƒ€ì„ ë³´ì•ˆ ëª¨ë‹ˆí„°ë§\n\n**í˜„ì¬ Falcoê°€ ì„¤ì¹˜ë˜ì–´ ìˆì§€ ì•ŠìŠµë‹ˆë‹¤.** Linux ì„œë²„ì—ì„œ Falcoë¥¼ í™œì„±í™”í•˜ë©´ ì´ ëŒ€ì‹œë³´ë“œì—ì„œ ëŸ°íƒ€ì„ ìœ„í˜‘ì„ ëª¨ë‹ˆí„°ë§í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n### í™œì„±í™” ë°©ë²•\n1. `docker-compose.yml`ì—ì„œ `falco` ë° `falco-sidekick` ì„œë¹„ìŠ¤ ì£¼ì„ í•´ì œ\n2. `docker-compose up -d falco falco-sidekick` ì‹¤í–‰\n\nâš ï¸ **ì£¼ì˜**: FalcoëŠ” Linux ì»¤ë„ ëª¨ë“ˆì´ í•„ìš”í•©ë‹ˆë‹¤. Docker Desktop(Mac/Windows)ì—ì„œëŠ” ë™ì‘í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤."
      }
    },
    {
      "id": 2,
      "title": "ğŸš¨ ëŸ°íƒ€ì„ ìœ„í˜‘ ì´ë²¤íŠ¸ ì¶”ì´",
      "type": "timeseries",
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 4 },
      "datasource": { "type": "loki", "uid": "loki" },
      "targets": [
        {
          "expr": "sum(count_over_time({job=\"falco\"} |~ \"(?i)(critical|warning|error)\" [5m])) by (priority)",
          "legendFormat": "{{priority}}",
          "refId": "A"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": { "fillOpacity": 30, "lineWidth": 2 }
        }
      }
    },
    {
      "id": 3,
      "title": "ğŸ“Š ìœ„í˜‘ ìœ í˜• ë¶„í¬",
      "type": "piechart",
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 4 },
      "datasource": { "type": "loki", "uid": "loki" },
      "targets": [
        {
          "expr": "sum(count_over_time({job=\"falco\"} |~ \"shell\" [$__range]))",
          "legendFormat": "Shell Spawned",
          "refId": "A"
        },
        {
          "expr": "sum(count_over_time({job=\"falco\"} |~ \"sensitive.*file\" [$__range]))",
          "legendFormat": "Sensitive File Access",
          "refId": "B"
        },
        {
          "expr": "sum(count_over_time({job=\"falco\"} |~ \"network|connection\" [$__range]))",
          "legendFormat": "Network Activity",
          "refId": "C"
        },
        {
          "expr": "sum(count_over_time({job=\"falco\"} |~ \"privilege|root\" [$__range]))",
          "legendFormat": "Privilege Escalation",
          "refId": "D"
        }
      ],
      "options": { "legend": { "displayMode": "table", "placement": "right" } }
    },
    {
      "id": 4,
      "title": "ğŸ”´ Critical/Warning ì´ë²¤íŠ¸",
      "type": "logs",
      "gridPos": { "h": 10, "w": 24, "x": 0, "y": 12 },
      "datasource": { "type": "loki", "uid": "loki" },
      "targets": [
        {
          "expr": "{job=\"falco\"} |~ \"(?i)(critical|warning)\"",
          "refId": "A"
        }
      ],
      "options": {
        "showTime": true,
        "showLabels": true,
        "wrapLogMessage": true,
        "sortOrder": "Descending",
        "enableLogDetails": true
      }
    },
    {
      "id": 5,
      "title": "ğŸš ì‰˜ ì‹¤í–‰ ê°ì§€",
      "type": "logs",
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 22 },
      "datasource": { "type": "loki", "uid": "loki" },
      "targets": [
        {
          "expr": "{job=\"falco\"} |~ \"(?i)(shell|bash|sh|terminal)\"",
          "refId": "A"
        }
      ],
      "options": { "showTime": true, "wrapLogMessage": true, "sortOrder": "Descending" }
    },
    {
      "id": 6,
      "title": "ğŸ“ ë¯¼ê° íŒŒì¼ ì ‘ê·¼",
      "type": "logs",
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 22 },
      "datasource": { "type": "loki", "uid": "loki" },
      "targets": [
        {
          "expr": "{job=\"falco\"} |~ \"(?i)(shadow|passwd|sensitive|secret|credential|key)\"",
          "refId": "A"
        }
      ],
      "options": { "showTime": true, "wrapLogMessage": true, "sortOrder": "Descending" }
    }
  ]
}

