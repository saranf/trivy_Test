{
  "annotations": { "list": [] },
  "editable": true,
  "fiscalYearStartMonth": 0,
  "graphTooltip": 0,
  "id": null,
  "links": [
    {
      "asDropdown": false,
      "icon": "dashboard",
      "includeVars": true,
      "keepTime": true,
      "tags": [],
      "targetBlank": true,
      "title": "ğŸ“‹ ì „ì²´ ë¡œê·¸",
      "type": "link",
      "url": "/d/loki-logs/container-logs-loki"
    }
  ],
  "liveNow": true,
  "refresh": "5s",
  "schemaVersion": 38,
  "tags": ["loki", "security", "errors", "alerts"],
  "templating": {
    "list": [
      {
        "current": { "selected": true, "text": "All", "value": "$__all" },
        "datasource": { "type": "loki", "uid": "loki" },
        "definition": "label_values(container)",
        "hide": 0,
        "includeAll": true,
        "label": "Container",
        "multi": true,
        "name": "container",
        "options": [],
        "query": "label_values(container)",
        "refresh": 2,
        "sort": 1,
        "type": "query"
      }
    ]
  },
  "time": { "from": "now-1h", "to": "now" },
  "title": "ğŸš¨ Security & Error Logs",
  "uid": "security-logs",
  "version": 1,
  "panels": [
    {
      "id": 1,
      "title": "ğŸš¨ ì—ëŸ¬ ë°œìƒ ì¶”ì´",
      "type": "timeseries",
      "gridPos": { "h": 6, "w": 12, "x": 0, "y": 0 },
      "datasource": { "type": "loki", "uid": "loki" },
      "targets": [
        {
          "expr": "sum(count_over_time({container=~\"$container\"} |~ \"(?i)(error|exception|fatal|panic|critical)\" [1m])) by (container)",
          "legendFormat": "{{container}}",
          "refId": "A"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": { "fillOpacity": 30, "lineWidth": 2 }
        }
      }
    },
    {
      "id": 2,
      "title": "âš ï¸ ê²½ê³  ë°œìƒ ì¶”ì´",
      "type": "timeseries",
      "gridPos": { "h": 6, "w": 12, "x": 12, "y": 0 },
      "datasource": { "type": "loki", "uid": "loki" },
      "targets": [
        {
          "expr": "sum(count_over_time({container=~\"$container\"} |~ \"(?i)(warn|warning)\" [1m])) by (container)",
          "legendFormat": "{{container}}",
          "refId": "A"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "palette-classic" },
          "custom": { "fillOpacity": 30, "lineWidth": 2 }
        }
      }
    },
    {
      "id": 3,
      "title": "ğŸ“Š ë¡œê·¸ ë ˆë²¨ ë¶„í¬",
      "type": "piechart",
      "gridPos": { "h": 8, "w": 6, "x": 0, "y": 6 },
      "datasource": { "type": "loki", "uid": "loki" },
      "targets": [
        {
          "expr": "sum(count_over_time({container=~\"$container\"} |~ \"(?i)error\" [$__range]))",
          "legendFormat": "ERROR",
          "refId": "A"
        },
        {
          "expr": "sum(count_over_time({container=~\"$container\"} |~ \"(?i)warn\" [$__range]))",
          "legendFormat": "WARN",
          "refId": "B"
        },
        {
          "expr": "sum(count_over_time({container=~\"$container\"} |~ \"(?i)info\" [$__range]))",
          "legendFormat": "INFO",
          "refId": "C"
        }
      ],
      "options": { "legend": { "displayMode": "table", "placement": "right" } }
    },
    {
      "id": 4,
      "title": "ğŸ”´ Critical/Fatal ë¡œê·¸",
      "type": "logs",
      "gridPos": { "h": 8, "w": 18, "x": 6, "y": 6 },
      "datasource": { "type": "loki", "uid": "loki" },
      "targets": [
        {
          "expr": "{container=~\"$container\"} |~ \"(?i)(critical|fatal|panic|emergency)\"",
          "refId": "A"
        }
      ],
      "options": {
        "showTime": true,
        "showLabels": true,
        "showCommonLabels": false,
        "wrapLogMessage": true,
        "sortOrder": "Descending",
        "dedupStrategy": "none",
        "enableLogDetails": true
      }
    },
    {
      "id": 5,
      "title": "ğŸ”´ Error ë¡œê·¸ (ì‹¤ì‹œê°„)",
      "type": "logs",
      "gridPos": { "h": 10, "w": 24, "x": 0, "y": 14 },
      "datasource": { "type": "loki", "uid": "loki" },
      "targets": [
        {
          "expr": "{container=~\"$container\"} |~ \"(?i)(error|exception|failed|failure)\"",
          "refId": "A"
        }
      ],
      "options": {
        "showTime": true,
        "showLabels": true,
        "wrapLogMessage": true,
        "sortOrder": "Descending",
        "enableLogDetails": true
      }
    },
    {
      "id": 6,
      "title": "ğŸ” ì¸ì¦/ê¶Œí•œ ê´€ë ¨ ë¡œê·¸",
      "type": "logs",
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 24 },
      "datasource": { "type": "loki", "uid": "loki" },
      "targets": [
        {
          "expr": "{container=~\"$container\"} |~ \"(?i)(auth|login|logout|permission|denied|unauthorized|forbidden|access)\"",
          "refId": "A"
        }
      ],
      "options": {
        "showTime": true,
        "showLabels": true,
        "wrapLogMessage": true,
        "sortOrder": "Descending",
        "enableLogDetails": true
      }
    },
    {
      "id": 7,
      "title": "ğŸ›¡ï¸ ë³´ì•ˆ ì´ë²¤íŠ¸ (Trivy/CVE)",
      "type": "logs",
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 24 },
      "datasource": { "type": "loki", "uid": "loki" },
      "targets": [
        {
          "expr": "{container=~\"$container\"} |~ \"(?i)(CVE-|vulnerability|trivy|scan|security|exploit|attack)\"",
          "refId": "A"
        }
      ],
      "options": {
        "showTime": true,
        "showLabels": true,
        "wrapLogMessage": true,
        "sortOrder": "Descending",
        "enableLogDetails": true
      }
    },
    {
      "id": 8,
      "title": "ğŸŒ ë„¤íŠ¸ì›Œí¬/ì—°ê²° ì´ìŠˆ",
      "type": "logs",
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 32 },
      "datasource": { "type": "loki", "uid": "loki" },
      "targets": [
        {
          "expr": "{container=~\"$container\"} |~ \"(?i)(connection refused|timeout|unreachable|network|socket|dns|port)\" |~ \"(?i)(error|fail|refused)\"",
          "refId": "A"
        }
      ],
      "options": {
        "showTime": true,
        "showLabels": true,
        "wrapLogMessage": true,
        "sortOrder": "Descending",
        "enableLogDetails": true
      }
    },
    {
      "id": 9,
      "title": "ğŸ’¾ ë°ì´í„°ë² ì´ìŠ¤ ì—ëŸ¬",
      "type": "logs",
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 32 },
      "datasource": { "type": "loki", "uid": "loki" },
      "targets": [
        {
          "expr": "{container=~\"$container\"} |~ \"(?i)(mysql|database|sql|query|deadlock|lock wait)\" |~ \"(?i)(error|fail|exception)\"",
          "refId": "A"
        }
      ],
      "options": {
        "showTime": true,
        "showLabels": true,
        "wrapLogMessage": true,
        "sortOrder": "Descending",
        "enableLogDetails": true
      }
    },
    {
      "id": 10,
      "title": "ğŸ“ˆ ì‹œê°„ë³„ ì—ëŸ¬ íˆíŠ¸ë§µ",
      "type": "heatmap",
      "gridPos": { "h": 6, "w": 24, "x": 0, "y": 40 },
      "datasource": { "type": "loki", "uid": "loki" },
      "targets": [
        {
          "expr": "sum(count_over_time({container=~\"$container\"} |~ \"(?i)error\" [5m])) by (container)",
          "legendFormat": "{{container}}",
          "refId": "A"
        }
      ],
      "options": {
        "calculate": false,
        "cellGap": 1,
        "color": { "mode": "scheme", "scheme": "Oranges" }
      }
    }
  ]
}

